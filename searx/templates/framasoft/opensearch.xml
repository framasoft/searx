{% from 'framasoft/macros.html' import which_host %}
<?xml version="1.0" encoding="utf-8"?>
<OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/">
  <ShortName>{{ which_host() }}</ShortName>
  <Description>Search {{ which_host() }}</Description>
  <InputEncoding>UTF-8</InputEncoding>
  <Image>{{ host }}{{ url_for('static', filename='img/favicon.png') | replace("/", "", 1) }}</Image>
  <LongName>{{ which_host() }} metasearch</LongName>
  {% if opensearch_method == 'get' %}
    <Url type="text/html" method="get" template="{{ host }}search?q={searchTerms}"/>
    {% if autocomplete %}
    <Url type="application/x-suggestions+json" method="get" template="{{ host }}autocompleter">
        <Param name="format" value="x-suggestions" />
        <Param name="q" value="{searchTerms}" />
    </Url>
    {% endif %}
  {% else %}
    <Url type="text/html" method="post" template="{{ host }}">
        <Param name="q" value="{searchTerms}" />
    </Url>
    {% if autocomplete %}
    <!-- TODO, POST REQUEST doesn't work -->
    <Url type="application/x-suggestions+json" method="get" template="{{ host }}autocompleter">
        <Param name="format" value="x-suggestions" />
        <Param name="q" value="{searchTerms}" />
    </Url>
    {% endif %}
  {% endif %}
</OpenSearchDescription>
